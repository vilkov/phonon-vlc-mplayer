#summary Rationales, background and history of QuarkPlayer
#labels Phase-Design

= Introduction =

Rationales, background and history of !QuarkPlayer.
Yet another media player! Here my reasons for writing another media player...

Goals:
 * Multimedia (video and audio playback)
 * C++/Qt-4.4
 * Fast
 * Multiplatform
 * OS integration
 * Plugins system
 * Phonon library
 * I like to code

= History =

Everything started in march 2008 when I've discovered the video player [http://smplayer.sourceforge.net/ SMPlayer]. Until then I was using the well known [http://www.videolan.org/ VLC] video player under Windows (I am mostly a Windows users beside using GNU/Linux for about 10 years).

Compared to VLC (version 0.8.6 time of writing), SMPlayer has a much better GUI based on the [http://trolltech.com/ Qt] toolkit. (VLC 0.8.6 was based on [http://wxwidgets.org/ wxWidgets] before moving to Qt toolkit for 0.9 release).
Of course, as a developer, I've started to look at SMPlayer source code and found that there were no separation between the engine (which uses the very good [http://www.mplayerhq.hu/ MPlayer]) and the GUI.
At the same time, [http://phonon.kde.org/ Phonon], a multimedia API for Qt4, started to get mature and I was seduced by this thin multimedia layer where you can implement different backends (!DirectShow, Xine, GStreamer...)

I sent few [http://sourceforge.net/mailarchive/forum.php?thread_name=129f18a00803040503n68b72f33i49524d5405f7d777%40mail.gmail.com&forum_name=smplayer-development mails] to Ricardo Villalba, the SMPlayer author, about patching his video player for using Phonon instead of his own engine. He was pretty interested at first and I sent to him several [http://sourceforge.net/mailarchive/forum.php?thread_name=129f18a00804220111g7a92ead8l493c1c549c6391c2%40mail.gmail.com&forum_name=smplayer-development patches] and even submit experimental VLC and MPlayer backends for Phonon inside SMPlayer SVN repository.

Unfortunately, [http://smplayer.berlios.de/forums/viewtopic.php?pid=1668#p1668 "SMPlayer is so oriented to MPlayer that probably it would be necessary to rewrite it again from zero to use Phonon instead, and currently Phonon is very basic and doesn't allow all things that MPlayer can do."]

So I moved the experimental VLC and MPlayer backends to http://phonon-vlc-mplayer.googlecode.com/ and decided to create a simple media player in order to test my new backends...

= Rationales behind !QuarkPlayer =

!QuarkPlayer is designed to be a multimedia player, meaning not only for videos but also suitable for audio playback, similar to Windows Media Player approach. I want to play my videos with the same application that I use for music playback.

!QuarkPlayer started as a [http://phonon-vlc-mplayer.googlegroups.com/web/QuarkPlayer-0.1-win32-2.png?gda=zeMzP0wAAABAIzXrRkc0UJYuMPqsOGZvZi_IuTZWNTMOeWCE90_-qmG1qiJ7UbTIup-M2XPURDSDk6dLSXWTIU0t_YRCVF5xDeGi6XjxcWE2ApR61obtyA video player] very similar to SMPlayer GUI before I code a playlist and other more "music" oriented features.

=== Libraries dependencies ===

!QuarkPlayer only depends on Qt, not on KDE libraries. I think that !QuarkPlayer should be as fast as possible (a key factor of success in this area) and base it on KDE libraries would slow down the soft specially under Windows. Adding an important dependency like KDE makes it difficult to compile the software under Windows. I don't see yet any argument to introduce a KDE dependency compare to Qt features.

Under GNU/Linux, !QuarkPlayer can be compiled if needed with a minimal "visual" support for KDE. !TkUtil tries to achieve this goal by using KMainWindow for example instead of QMainWindow. This process is totally transparent from the rest of the source code.

=== Portability ===

Windows is the most used OS, when you use the portable Qt library it would have been stupid to only support GNU/Linux. Windows also comes with tools for developing: debugger and compiler from Visual C++ 2005 are for free and very good.
Supporting more compilers and platforms help to find bugs.
Therefore, !QuarkPlayer compiles with Visual C++ 2005, MinGW and GCC for GNU/Linux.
Unfortunately I don't have a MacOS computer, that's why there is no available version under this OS. Help is very welcome here.

=== C++ ===

As said before, speed is a key factor of success for a video/audio player.
Popular players are fast: Winamp, Foobar2000, VLC...
One could think of using Python/Qt instead of C++/Qt, but I think it would slow down !QuarkPlayer startup time and increase memory consumption.

=== Free software ===

Free as in free speech, not as in free beer. Source code is under GPLv3+

=== Skins support ===

I'm not a big skins fan, I prefer good OS integration and this is what Qt brings.
If someone wants skins support, Qt CSS support is [http://doc.trolltech.com/main-snapshot/stylesheet.html here].

=== Phonon ===

Phonon is a very well written multimedia API: easy, portable, small footprint...
I thank everyday Matthias Kretz, the author, for developing such a good library!
I still have a lot of patches for him :/

!QuarkPlayer name comes from [http://en.wikipedia.org/wiki/Quark Quark] to keep it in physics area like [http://en.wikipedia.org/wiki/Phonon Phonon].

=== VLC and MPlayer backends ===

When it comes to multiplatform audio/video engines, you have the choice between VLC and MPlayer. Let's integrate both inside Phonon library!

=== "Windows Explorer" panel ===

All my friends are big music fans and I discovered that there were using Winamp or Windows Media Player in conjunction with Windows Explorer to do some drag and drop from their music directory.
They don't use advanced features from Amarok or ITunes with tagging support even if they know them.

That's why I've decided to directly add a [http://phonon-vlc-mplayer.googlegroups.com/web/QuarkPlayer-20080626-win32-fullplugins.png?gda=_Ji1I1sAAABAIzXrRkc0UJYuMPqsOGZvZi_IuTZWNTMOeWCE90_-qmG1qiJ7UbTIup-M2XPURDRYEbqvAFjzWFrl9M5z94S3SZGsd5o1AwXI20RE_qYl0SJl3I5nvU7ZMR3tcW67EOQ "Windows Explorer" panel] inside !QuarkPlayer from where they can do drag&drop to the playlist.

= Architecture =

Moto:
 * Pushing intelligence to the edge
 * KISS Keep It Simple, Stupid
 * Small is Beautiful!

=== Everything are plugins... ===

A media player can contain a lot of features. Instead of having a big fatty monolithic software that can be difficult to maintain over time, a way better approach is to add features via a plugin system.
If you look at !QuarkPlayer source code, you will see that [http://code.google.com/p/phonon-vlc-mplayer/source/browse/trunk/quarkplayer/plugins?r=250 everything are plugins] and that !QuarkPlayer core is [http://code.google.com/p/phonon-vlc-mplayer/source/browse/trunk/quarkplayer?r=250 very small] (< 3000LOC).

=== Create libraries whenever you can ===

!QuarkPlayer comes with several small libraries that can be re-used:
 * !TkUtil, which is a utility library
 * !PlaylistParser for parsing m3u playlist and other formats
 * !ContentFetcher to download Internet contents (lyrics, Amazon cover, artist Wikipedia page)
 * !WebBrowser, a simple web browser based on QTextBrowser (so no !QtWebKit dependency)

= !QuarkPlayer vs other players =

 * [http://amarok.kde.org/ Amarok] depends on KDE libraries (slow under Windows) and only plays music
 * [http://www.videolan.org/ VLC] is not suitable for music playback
 * [http://smplayer.sourceforge.net/ SMPlayer] is not suitable for music playback
 * [http://www.mplayerhq.hu/ MPlayer] is not suitable for music playback
 * [http://www.dragonplayer.org/ DragonPlayer] depends on KDE libraries and is very basic
 * [http://dekibulle.free.fr/ DÃ©KiBulle] is not multiplatform (Delphi based) and plays only music
 * [http://musik.berlios.de/ wxMusik] plays only music
 * [http://www.gnome.org/projects/totem/ Totem] is not multiplatform (like 95% of GTK+/GNOME applications) and is not suitable for music playback
 * [http://www.kantaris.org/ Kantaris Media Player] could do it but is not multiplatform and relies on C# and uses closed source libraries
 * [http://jajuk.info/ Jajuk] is a Java based music application

ect...

I've tested a number of open source and closed source multimedia applications, this helps to take UI decisions, here some of them: 
http://code.google.com/p/phonon-vlc-mplayer/source/browse/competition

http://phonon-vlc-mplayer.googlegroups.com/web/QuarkPlayer-20080724-win32.png?gsc=F98u1AsAAACPmwBWT6bgpe7EAZoCOXfr